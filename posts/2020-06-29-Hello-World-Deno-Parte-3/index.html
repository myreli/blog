<!DOCTYPE html><html lang="en"><head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale = 1.0, maximum-scale=1.0">
    <meta name="author" content="Myreli <myreli@proton.me>">

    <title>Hello World, Deno! - Parte 3 - Visitando APIs Web | blog.myreli.dev</title>

    <link rel="stylesheet" href="https://unpkg.com/prismjs@1.28.0/themes/prism.min.css">
    <link rel="stylesheet" href="https://unpkg.com/@picocss/pico@latest/css/pico.classless.min.css">
    <style>
        :root {
            --spacing: .75rem;
        }

        html,
        body {
            overflow-x: hidden;
        }

        button { 
            --background-color: transparent;
            --color: var(--primary);
        }
    </style>
</head>

<body>
    <header>
        <nav>
            <ul>
                <li>
                  <a href="/">
                    <code>blog.myreli.dev</code>
                  </a>
                </li>
            </ul>
            <ul><li><a href="/about/">Sobre</a></li>
<li><a href="/posts/">Posts</a></li></ul>
        </nav>
        <hgroup>
            <h1 id="hello-world-deno-parte-3-visitando-apis-web">Hello World, Deno! - Parte 3 - Visitando APIs Web</h1>
            <h2 id="o-poder-do-javascript-do-browser-no-back-end-de-verdade-apis-da-web-em-deno">O poder do JavaScript do browser no Back-End de verdade - APIs da Web em Deno ü¶ï</h2>
        </hgroup>
        <hr>
    </header>
    <main>
        <p>Dale! Como vai?</p>
<p>No artigo anterior falamos sobre v√°rias coisas em busca de um √∫nico objetivo: preparar o terreno para o nosso aplicativo e entender um pouco da experi√™ncia de usu√°rio fornecida por Deno. Caso n√£o fa√ßa ideia do que estou falando, pode come√ßar a ler <a href="https://myreli.dev/blog/2020/05/16/Hello-World-Deno.html">aqui</a>.</p>
<blockquote>
<p>Demorei, mas voltei. :)</p>
<p>Pe√ßo desculpas pela demora eterna hehe. Caso tenha curiosidade de saber o porqu√™ de tanta demora, estou considerando abrir meu cora√ß√£o sobre aqui, mas enquanto isso <a href="https://vidasnegrasimportam.carrd.co/">acesse todos esses links</a>. Caso n√£o tome coragem para publicar quero dizer aos meus amigos, conhecidos e desconhecidos negros: Eu sinto muito. Vidas negras importam.</p>
<p>Al√©m disso, nesse √∫ltimo final de semana saiu a terceira e √∫ltima temporada de Dark.</p>
</blockquote>
<p>Hoje, vamos evoluir nossa aplica√ß√£o comunicando de verdade com o Chap√©u Seletor.</p>
<blockquote>
<p>Essa √© a terceira parte de uma s√©rie de artigos sobre Deno:</p>
</blockquote>
<ol>
<li><a href="https://myreli.dev/blog/2020/05/16/Hello-World-Deno.html">Hello World, Deno! - Parte I</a> <em>dispon√≠vel</em></li>
<li><a href="https://myreli.dev/blog/2020/05/18/Hello-World-Deno-Parte-2.html">Hello World, Deno! - Iniciando uma aplica√ß√£o - Parte II</a> <em>dispon√≠vel</em></li>
<li><a href="#">Hello World, Deno! - Visitando APIs Web - Parte III</a> <strong>voc√™ est√° aqui</strong></li>
<li><a href="#">Hello World, Deno! - Visitando APIS Nativas - Parte IV</a> <em>em breve</em></li>
<li><a href="#">Hello World, Deno! - Considera√ß√µes finais Parte V</a> <em>em breve</em></li>
</ol>
<p>Lembra a introdu√ß√£o sobre Deno em que fizemos uma chamada no terminal para o chap√©u seletor e ele dizia qual era a casa?</p>
<p>Pois ent√£o, vamos trazer aquela m√°gica para dentro do nosso c√≥digo.</p>
<h3 id="comunicacao-acessando-e-consumindo-apis-com-deno">Comunica√ß√£o: acessando e consumindo APIs com Deno</h3>
<p>Precisamos comunicar com o Chap√©u Seletor e isso ocorre atrav√©s de uma <em>interface</em>, como mencionado anteriormente. Essa interface, conhecida como API, √© uma interface HTTP dispon√≠vel atrav√©s da URL: <a href="https://www.potterapi.com/v1/sortingHat/">https://www.potterapi.com/v1/sortingHat/</a>.</p>
<p>O que precisamos fazer √©: acessar essa URL atrav√©s do nosso programa para relacionar o sorteio ao aluno sorteado.</p>
<p>Anteriormente, atrav√©s de um terminal, a comunica√ß√£o foi feita dessa forma:</p>
<pre class="language-shell"><code class="language-shell">deno run https://deno.land/std/examples/curl.ts https://www.potterapi.com/v1/sortingHat/ --allow-net<span class="token operator">=</span>www.potterapi.com</code></pre>
<p>Desmembrando cada parte desse comando, temos o seguinte:</p>
<table>
<thead>
<tr>
<th>comando</th>
<th>descri√ß√£o</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>deno run</code></td>
<td>utilizamos o global Deno para invocar a sua fun√ß√£o <code>run</code>, que serve para executar um script Deno</td>
</tr>
<tr>
<td><code>https://deno.land/std/examples/curl.ts</code></td>
<td>definimos que o programa a ser executado √© o <code>curl.ts</code>, dispon√≠vel em https://deno.land/std/examples/</td>
</tr>
<tr>
<td><code>https://www.potterapi.com/v1/sortingHat/</code></td>
<td>passamos como par√¢metro para este programa a API de Harry Potter no endpoint do Chap√©u Seletor</td>
</tr>
<tr>
<td><code>--allow-net=www.potterapi.com</code></td>
<td>permitimos a comunica√ß√£o com a internet no endpoint especificado</td>
</tr>
</tbody>
</table>
<p>Ou seja, utilizamos um programa chamado <code>curl</code> do Deno para acessar uma p√°gina e exibir o resultado dela. Esse programa visita a p√°gina de Harry Potter, processa o conte√∫do dela e retorna para quem chamou, mas podemos fazer isso de forma direta.</p>
<p>Poder√≠amos importar este programa dentro do nosso e utilizar? Sim! Mas, neste caso, √© mais r√°pido (e f√°cil) chamarmos atrav√©s de uma Web API em nossa aplica√ß√£o do que atrav√©s de um outro programa e recuperar o conte√∫do direto da fonte.</p>
<p>Em s√≠ntese: nossa CLI precisa acessar a internet no endere√ßo da API, a API falar√° com o chap√©u seletor e retornar√° para a casa sorteada.</p>
<h3 id="javascript-back-end-deno-web-apis">JavaScript, Back-End, Deno... Web APIs?</h3>
<p>Deno tem o compromisso de n√£o reinventar a roda (quando a roda funciona bem :stuck_out_tongue_winking_eye:) e por isso as APIs da Web que j√° s√£o s√≥lidas e atendem todas as necessidades s√£o trazidas do Browser atrav√©s de Deno.</p>
<p>Um exemplo dessas APIs √© o <a href="https://developer.mozilla.org/en-US/docs/Web/API/Fetch_API">fetch</a> que em sua forma mais simples funciona assim:</p>
<pre class="language-typescript"><code class="language-typescript"><span class="token comment">// collect raw response from URL</span><br><span class="token keyword">const</span> rawResponse <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token function">fetch</span><span class="token punctuation">(</span><span class="token string">'URL'</span><span class="token punctuation">)</span><br><span class="token comment">// proccess response as structured data</span><br><span class="token keyword">const</span> body <span class="token operator">=</span> <span class="token keyword">await</span> rawResponse<span class="token punctuation">.</span><span class="token function">text</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">// OR .json()</span></code></pre>
<p>Primeiro, existe a fun√ß√£o <code>fetch()</code> que retorna uma <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Promise">promise</a> contendo m√©todos utilit√°rios e a resposta pura da p√°gina. Depois, utilizamos um desses m√©todos para processar a resposta no formato que desejamos, por exemplo, texto ou JSON.</p>
<p>Agora vamos testar nossa pr√≥pria implementa√ß√£o para chamar a API de Harry Potter e mostrar a casa sorteada.</p>
<p>Para isso, utilizamos essa API e basta substituir o texto <code>'URL'</code> pela URL que queremos chamar, neste caso, a do Chap√©u Seletor. Em um arquivo <code>.ts</code> qualquer, vai ser algo, mais ou menos, assim:</p>
<p><picture><source type="image/avif" srcset="/assets/3zlGMm-QgHEetzQYV-150w.avif 150w, /assets/3zlGMm-QgHEetzQYV-300w.avif 300w, /assets/3zlGMm-QgHEetzQYV-450w.avif 450w, /assets/3zlGMm-QgHEetzQYV-600w.avif 600w, /assets/3zlGMm-QgHEetzQYV-750w.avif 750w, /assets/3zlGMm-QgHEetzQYV-900w.avif 900w" sizes="100vw"><source type="image/webp" srcset="/assets/3zlGMm-QgHEetzQYV-150w.webp 150w, /assets/3zlGMm-QgHEetzQYV-300w.webp 300w, /assets/3zlGMm-QgHEetzQYV-450w.webp 450w, /assets/3zlGMm-QgHEetzQYV-600w.webp 600w, /assets/3zlGMm-QgHEetzQYV-750w.webp 750w, /assets/3zlGMm-QgHEetzQYV-900w.webp 900w" sizes="100vw"><source type="image/jpeg" srcset="/assets/3zlGMm-QgHEetzQYV-150w.jpeg 150w, /assets/3zlGMm-QgHEetzQYV-300w.jpeg 300w, /assets/3zlGMm-QgHEetzQYV-450w.jpeg 450w, /assets/3zlGMm-QgHEetzQYV-600w.jpeg 600w, /assets/3zlGMm-QgHEetzQYV-750w.jpeg 750w, /assets/3zlGMm-QgHEetzQYV-900w.jpeg 900w" sizes="100vw"><img src="/assets/3zlGMm-QgHEetzQYV-600w.jpeg" width="900" height="571" loading="lazy" decoding="async"></picture></p>
<p>Para executar, lembre-se de permitir corretamente o acesso a rede.</p>
<p>Existem v√°√°rias outras APIs da Web implementadas, inclusive <strong><a href="https://doc.deno.land/https/github.com/denoland/deno/releases/latest/download/lib.deno.d.ts#addEventListener">addEventListener</a>!!!</strong> Todas as fun√ß√µes est√£o dispon√≠veis na <a href="https://doc.deno.land/https/github.com/denoland/deno/releases/latest/download/lib.deno.d.ts#fetch">documenta√ß√£o oficial</a>.</p>
<h3 id="but-first">But first...</h3>
<p><s><a href="https://www.youtube.com/watch?v=SuyG-lIkNow">Let me take a selfie</a></s> Vamos estruturar a aplica√ß√£o =D</p>
<p>At√© o momento temos as pe√ßas do nosso projeto de forma separadas ent√£o precisamos fazer um trabalho de <em>refatora√ß√£o</em> para preparar todas as etapas. E, ent√£o, ir preenchendo cada parte e formar o resultado final.</p>
<blockquote>
<p>No geral, eu gosto da pr√°tica de ir planejando a estrutura do c√≥digo de forma macro antes de ir resolvendo cada problema de forma individual. Otimiza a solu√ß√£o de problemas grandes, favorece o sistema de recompensas do c√©rebro e encaixa muito bem com TDD.</p>
</blockquote>
<p>Do √∫ltimo artigo discutimos sobre qual seria a estrutura, mas n√£o executamos ela de fato. E encerramos assim:</p>
<p><picture><source type="image/avif" srcset="/assets/PolDPR-8pn_eKwGQQ-150w.avif 150w, /assets/PolDPR-8pn_eKwGQQ-300w.avif 300w, /assets/PolDPR-8pn_eKwGQQ-450w.avif 450w, /assets/PolDPR-8pn_eKwGQQ-600w.avif 600w" sizes="100vw"><source type="image/webp" srcset="/assets/PolDPR-8pn_eKwGQQ-150w.webp 150w, /assets/PolDPR-8pn_eKwGQQ-300w.webp 300w, /assets/PolDPR-8pn_eKwGQQ-450w.webp 450w, /assets/PolDPR-8pn_eKwGQQ-600w.webp 600w" sizes="100vw"><source type="image/jpeg" srcset="/assets/PolDPR-8pn_eKwGQQ-150w.jpeg 150w, /assets/PolDPR-8pn_eKwGQQ-300w.jpeg 300w, /assets/PolDPR-8pn_eKwGQQ-450w.jpeg 450w, /assets/PolDPR-8pn_eKwGQQ-600w.jpeg 600w" sizes="100vw"><img src="/assets/PolDPR-8pn_eKwGQQ-450w.jpeg" width="600" height="255" loading="lazy" decoding="async"></picture></p>
<p>Agora vamos fazer aplicar essa estrutura. Apesar de ser uma simples CLI √© importante manter as coisas minimamente organizadas, principalmente para no artigo final quando dermos uma olhadinha na suite nativa de testes. :)</p>
<p>A primeira coisa que eu fiz foi mover a l√≥gica anterior para uma fun√ß√£o chamada <code>identifyStudent</code> e chamar essa fun√ß√£o dentro do meu arquivo.</p>
<p><picture><source type="image/avif" srcset="/assets/VhVN41-muNOFnvvnM-150w.avif 150w, /assets/VhVN41-muNOFnvvnM-300w.avif 300w, /assets/VhVN41-muNOFnvvnM-450w.avif 450w, /assets/VhVN41-muNOFnvvnM-600w.avif 600w, /assets/VhVN41-muNOFnvvnM-750w.avif 750w, /assets/VhVN41-muNOFnvvnM-900w.avif 900w, /assets/VhVN41-muNOFnvvnM-1050w.avif 1050w, /assets/VhVN41-muNOFnvvnM-1200w.avif 1200w, /assets/VhVN41-muNOFnvvnM-1350w.avif 1350w" sizes="100vw"><source type="image/webp" srcset="/assets/VhVN41-muNOFnvvnM-150w.webp 150w, /assets/VhVN41-muNOFnvvnM-300w.webp 300w, /assets/VhVN41-muNOFnvvnM-450w.webp 450w, /assets/VhVN41-muNOFnvvnM-600w.webp 600w, /assets/VhVN41-muNOFnvvnM-750w.webp 750w, /assets/VhVN41-muNOFnvvnM-900w.webp 900w, /assets/VhVN41-muNOFnvvnM-1050w.webp 1050w, /assets/VhVN41-muNOFnvvnM-1200w.webp 1200w, /assets/VhVN41-muNOFnvvnM-1350w.webp 1350w" sizes="100vw"><source type="image/jpeg" srcset="/assets/VhVN41-muNOFnvvnM-150w.jpeg 150w, /assets/VhVN41-muNOFnvvnM-300w.jpeg 300w, /assets/VhVN41-muNOFnvvnM-450w.jpeg 450w, /assets/VhVN41-muNOFnvvnM-600w.jpeg 600w, /assets/VhVN41-muNOFnvvnM-750w.jpeg 750w, /assets/VhVN41-muNOFnvvnM-900w.jpeg 900w, /assets/VhVN41-muNOFnvvnM-1050w.jpeg 1050w, /assets/VhVN41-muNOFnvvnM-1200w.jpeg 1200w, /assets/VhVN41-muNOFnvvnM-1350w.jpeg 1350w" sizes="100vw"><img src="/assets/VhVN41-muNOFnvvnM-750w.jpeg" width="1350" height="653" loading="lazy" decoding="async"></picture></p>
<p>Tudo funciona exatamente como antes, mas agora temos um c√≥digo mais leg√≠vel.</p>
<blockquote>
<p><strong>#code-tip:</strong> execute <code>deno info mod.ts</code> para inspecionar todas as depend√™ncias do seu projeto e tenha de forma detalhada a origem de tudo:</p>
<pre class="language-shell"><code class="language-shell">‚ûú  hello-deno-harry-potter <span class="token punctuation">(</span>hello-web-apis<span class="token punctuation">)</span> ‚úó deno info mod.ts                       <br>local: /home/myreli/code/deno/hello-deno-harry-potter/mod.ts<br>type: TypeScript<br>compiled: /home/myreli/.cache/deno/gen/file/home/myreli/code/deno/hello-deno-harry-potter/mod.ts.js<br>map: /home/myreli/.cache/deno/gen/file/home/myreli/code/deno/hello-deno-harry-potter/mod.ts.js.map<br>deps:<br>file:///home/myreli/code/deno/hello-deno-harry-potter/mod.ts<br>  ‚îú‚îÄ‚îÄ file:///home/myreli/code/deno/hello-deno-harry-potter/student.ts<br>  ‚îú‚îÄ‚îÄ file:///home/myreli/code/deno/hello-deno-harry-potter/log.service.ts<br>  ‚îî‚îÄ‚îÄ file:///home/myreli/code/deno/hello-deno-harry-potter/sorting_hat.service.ts</code></pre>
</blockquote>
<p>Seguindo o mesmo procedimento para os outros dois que precisamos, vamos terminar com algo assim:</p>
<p><picture><source type="image/avif" srcset="/assets/74mpmF-3p2bicO97C-150w.avif 150w, /assets/74mpmF-3p2bicO97C-300w.avif 300w, /assets/74mpmF-3p2bicO97C-450w.avif 450w, /assets/74mpmF-3p2bicO97C-600w.avif 600w, /assets/74mpmF-3p2bicO97C-750w.avif 750w, /assets/74mpmF-3p2bicO97C-900w.avif 900w, /assets/74mpmF-3p2bicO97C-1050w.avif 1050w, /assets/74mpmF-3p2bicO97C-1200w.avif 1200w, /assets/74mpmF-3p2bicO97C-1350w.avif 1350w" sizes="100vw"><source type="image/webp" srcset="/assets/74mpmF-3p2bicO97C-150w.webp 150w, /assets/74mpmF-3p2bicO97C-300w.webp 300w, /assets/74mpmF-3p2bicO97C-450w.webp 450w, /assets/74mpmF-3p2bicO97C-600w.webp 600w, /assets/74mpmF-3p2bicO97C-750w.webp 750w, /assets/74mpmF-3p2bicO97C-900w.webp 900w, /assets/74mpmF-3p2bicO97C-1050w.webp 1050w, /assets/74mpmF-3p2bicO97C-1200w.webp 1200w, /assets/74mpmF-3p2bicO97C-1350w.webp 1350w" sizes="100vw"><source type="image/jpeg" srcset="/assets/74mpmF-3p2bicO97C-150w.jpeg 150w, /assets/74mpmF-3p2bicO97C-300w.jpeg 300w, /assets/74mpmF-3p2bicO97C-450w.jpeg 450w, /assets/74mpmF-3p2bicO97C-600w.jpeg 600w, /assets/74mpmF-3p2bicO97C-750w.jpeg 750w, /assets/74mpmF-3p2bicO97C-900w.jpeg 900w, /assets/74mpmF-3p2bicO97C-1050w.jpeg 1050w, /assets/74mpmF-3p2bicO97C-1200w.jpeg 1200w, /assets/74mpmF-3p2bicO97C-1350w.jpeg 1350w" sizes="100vw"><img src="/assets/74mpmF-3p2bicO97C-750w.jpeg" width="1350" height="551" loading="lazy" decoding="async"></picture></p>
<p>Algumas coisas importantes:</p>
<ul>
<li>preparei toda a estrutura do que ser√° nosso programa final, de forma que agora precisamos apenas preencher os espa√ßos</li>
<li>diferente do Node, Deno <em>sempre</em> encerra o processo caso algum erro n√£o tratado ocorra. ent√£o √© importante sempre lembrar de lidar com eles. (o <code>try/catch</code> gen√©rico ao redor de tudo √© a forma como vamos lidar agora)</li>
<li>n√£o se preocupe em fazer tudo como eu fiz, as pe√ßas podem ser reunidas de diversas formas diferentes e essa n√£o √© a melhor :)</li>
</ul>
<h3 id="implementando-a-comunicacao">Implementando a comunica√ß√£o</h3>
<p>Vamos implementar na fun√ß√£o <code>identifyHouse</code> a chamada a API externa do Harry Potter? yo o/</p>
<p>Primeiro √© necess√°rio coletar a resposta da API:</p>
<pre class="language-typescript"><code class="language-typescript"><span class="token keyword">const</span> response <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token function">fetch</span><span class="token punctuation">(</span><span class="token string">"https://www.potterapi.com/v1/sortingHat/"</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>
<p>Depois transformar essa resposta em texto e salvar a casa:</p>
<pre class="language-typescript"><code class="language-typescript"><span class="token keyword">const</span> house <span class="token operator">=</span> <span class="token keyword">await</span> response<span class="token punctuation">.</span><span class="token function">text</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>
<p>E, finalmente, retornar a casa para que o processamento possa seguir em frente:</p>
<pre class="language-typescript"><code class="language-typescript"><span class="token keyword">return</span> house<span class="token punctuation">;</span></code></pre>
<p>Agora, retornando para o nosso terminal, vamos ver como ficou tudo no final. Lembre-se de utilizar a flag de permiss√£o de internet dessa vez, j√° que estamos acessando a internet:</p>
<p><picture><source type="image/avif" srcset="/assets/iMteDR-YvJz-23GrM-150w.avif 150w, /assets/iMteDR-YvJz-23GrM-300w.avif 300w, /assets/iMteDR-YvJz-23GrM-450w.avif 450w, /assets/iMteDR-YvJz-23GrM-600w.avif 600w, /assets/iMteDR-YvJz-23GrM-750w.avif 750w, /assets/iMteDR-YvJz-23GrM-900w.avif 900w, /assets/iMteDR-YvJz-23GrM-1050w.avif 1050w, /assets/iMteDR-YvJz-23GrM-1200w.avif 1200w, /assets/iMteDR-YvJz-23GrM-1350w.avif 1350w" sizes="100vw"><source type="image/webp" srcset="/assets/iMteDR-YvJz-23GrM-150w.webp 150w, /assets/iMteDR-YvJz-23GrM-300w.webp 300w, /assets/iMteDR-YvJz-23GrM-450w.webp 450w, /assets/iMteDR-YvJz-23GrM-600w.webp 600w, /assets/iMteDR-YvJz-23GrM-750w.webp 750w, /assets/iMteDR-YvJz-23GrM-900w.webp 900w, /assets/iMteDR-YvJz-23GrM-1050w.webp 1050w, /assets/iMteDR-YvJz-23GrM-1200w.webp 1200w, /assets/iMteDR-YvJz-23GrM-1350w.webp 1350w" sizes="100vw"><source type="image/jpeg" srcset="/assets/iMteDR-YvJz-23GrM-150w.jpeg 150w, /assets/iMteDR-YvJz-23GrM-300w.jpeg 300w, /assets/iMteDR-YvJz-23GrM-450w.jpeg 450w, /assets/iMteDR-YvJz-23GrM-600w.jpeg 600w, /assets/iMteDR-YvJz-23GrM-750w.jpeg 750w, /assets/iMteDR-YvJz-23GrM-900w.jpeg 900w, /assets/iMteDR-YvJz-23GrM-1050w.jpeg 1050w, /assets/iMteDR-YvJz-23GrM-1200w.jpeg 1200w, /assets/iMteDR-YvJz-23GrM-1350w.jpeg 1350w" sizes="100vw"><img src="/assets/iMteDR-YvJz-23GrM-750w.jpeg" width="1350" height="710" loading="lazy" decoding="async"></picture></p>
<blockquote>
<p><strong>#code-tip:</strong> a qualquer momento voc√™ pode executar <code>deno fmt &lt;arquivo&gt;</code> para formatar seu arquivo com as indenta√ß√µes, espa√ßamentos e organiza√ß√£o corretinhas :wink:</p>
</blockquote>
<h3 id="proximos-passos">Pr√≥ximos passos</h3>
<p>E √© isso! Um artigo inteiro para tr√™s linhas de c√≥digo :stuck_out_tongue_closed_eyes: mas espero que tenha valido a pena! Em compara√ß√£o, caso voc√™ n√£o conhe√ßa node.js, uma requisi√ß√£o de forma nativa seria feita dessa forma:</p>
<pre class="language-javascript"><code class="language-javascript"><span class="token keyword">const</span> https <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'https'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><br>https<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">'https://www.potterapi.com/v1/sortingHat/'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">response</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span><br>  <span class="token keyword">let</span> data <span class="token operator">=</span> <span class="token string">''</span><span class="token punctuation">;</span><br><br>  response<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">'data'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">chunk</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span><br>    data <span class="token operator">+=</span> chunk<span class="token punctuation">;</span><br>  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><br>  response<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">'end'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span><br>    console<span class="token punctuation">.</span><span class="token function">info</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">;</span><br>  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><br><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">"error"</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">error</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span><br>  console<span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">Um erro impediu que a sele√ß√£o fosse conclu√≠da </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>error<span class="token punctuation">.</span>message<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>
<p>Bleh! Por isso que a request ficou t√£o famosa que as pessoas come√ßaram a pensar que ela era "nativa". E a√≠ todo mundo se surpreendeu quando o criador decidiu <a href="https://github.com/request/request/issues/3142">encerrar o suporte</a>. (Com raz√µes com as quais concordo plenamente, por sinal)</p>
<p>No pr√≥ximo artigo vamos implementar a √∫ltima parte do nosso sistema para deixar o Chap√©u Seletor, a OMS e os bruxos felizes: escrita no arquivo de log. <s>Mas, para deixar a Myreli feliz vamos ter um √∫ltimo artigo de considera√ß√µes finais para outras curiosidades legais e √∫teis sobre Deno.</s></p>
<p>Todo o c√≥digo at√© agora est√° dispon√≠vel no <a href="https://github.com/myreli/hello-deno-harry-potter/tree/hello-web-apis">Github</a>.</p>
<p>Muito obrigada por ter lido at√© aqui! Espero que esteja sendo uma leitura e experi√™ncia prazerosa.</p>
<p>At√© breve.</p>

        
        
            <hr>
            
            <section id="discussion-section">
                <button onclick="loadDiscussionSection()">ver coment√°rios</button>
            </section>
        
    </main>

    <hr>
    
    <footer>
        <article>
            <p>Gostaria de receber esse conte√∫do por e-mail? Sem spam.</p>
            <form action="https://buttondown.email/api/emails/embed-subscribe/myreli" method="post" target="popupwindow" onsubmit="window.open('https://buttondown.email/myreli', 'popupwindow')">
                <input type="email" name="email" placeholder="E-mail" required="">
                <button data-tooltip="Todo o dia 15 voc√™ receber√° por e-mail a minha newsletter, incluindo os √∫ltimos artigos publicados aqui." type="submit">Receber um e-mail por m√™s</button>
            </form>
        </article>
        <hr>
        <p>Copyright ¬© <a href="https://myreli.dev">Myreli</a> 2022</p>
    </footer>
    <script>
        var HYVOR_TALK_WEBSITE = 545;
        var HYVOR_TALK_CONFIG  = {
            id: "/2020/06/29/Hello-World-Deno-Parte-3"
        }
        
        function loadDiscussionSection() {
          const discussions = document.getElementById('discussion-section')
          if (!discussions) return;

          discussions.children[0].setAttribute("aria-busy", true)
          
          const widget = document.createElement("div")
          widget.id = "hyvor-talk-view"

          const script = document.createElement("script")
          script.type = "text/javascript"
          script.src = "https://talk.hyvor.com/web-api/embed.js"
          
          discussions.replaceChildren(widget)
          document.body.appendChild(script)
        }
    </script>


</body></html>